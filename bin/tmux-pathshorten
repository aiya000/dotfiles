#!/bin/bash

# tmux用のpathshorten風の機能
# 最後のディレクトリ名は省略せず、途中のディレクトリのみ短縮

path="$1"

# ホームディレクトリを~に置換
path="${path/$HOME/~}"

# パスをスラッシュで分割
IFS='/' read -ra parts <<< "$path"

# 結果を格納する配列
result=()

# 各部分を処理
for ((i=0; i<${#parts[@]}; i++)); do
    part="${parts[i]}"

    # 空文字または~はそのまま
    if [[ -z "$part" || "$part" == "~" ]]; then
        result+=("$part")
    # 最後の要素はそのまま
    elif [[ $i -eq $((${#parts[@]}-1)) ]]; then
        result+=("$part")
    # 途中の要素は最初の4文字に短縮
    else
        result+=("${part:0:4}")
    fi
done

# 結果を結合して出力
IFS='/'
echo "${result[*]}"