#!/usr/bin/env zsh

# Original files: ~/.dotfiles/Preferences/.zshrc_env

export WINDOWS_USER=$(whoami.exe | tr -d '\r\n' | cut -d '\' -f 2)
export DOTFILES_ZSHRC_NVM_NODE_VERSION=v22.20.0
export DOTFILES_NVM_PATH=$HOME/.nvm/versions/node/$DOTFILES_ZSHRC_NVM_NODE_VERSION/bin

export BASH_TOYS_WHEN_POMODORO_TIMER_FINISHED="notify Pomodoro-Timer The-time-finished! $HOME/.dotfiles/bash-toys/assets/notification-1.mp3"
export BASH_TOYS_POMODORO_DEFAULT_INTERVAL=60

# export NODE_OPTIONS=--max-old-space-size=16384
# export DISPLAY=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}'):0.0
# PATH=$PATH:/usr/share/bash-completion/completions
PATH="$PATH:$DOTFILES_NVM_PATH"
PATH="$PATH:~/.GoPath/bin"
PATH="$PATH:/mnt/c/Users/$WINDOWS_USER/AppData/Local/Programs/Microsoft VS Code"
PATH="$PATH:/mnt/c/Program Files/Rancher Desktop/resources/resources/linux/bin"
PATH="$PATH:/mnt/c/Program Files (x86)/Bluetooth Command Line Tools/bin"
PATH="$PATH:/mnt/c/Users/$WINDOWS_USER/Desktop/Programs/android-platform-tools"

if ! i-have code && i-have Code.exe ; then
  alias code=Code.exe
fi

# To enable npm and GitHub Copilot (copilot.vim)
load-my-env nvm
if [[ $VIM_TERMINAL == '' && $NEOVIM_TERMINAL == '' ]] ; then
  dotfiles::find_nodejs_to_load
fi

if [[ $VIM_TERMINAL != '' || $NEOVIM_TERMINAL != '' ]] ; then
  xl
fi

# - - -
# The following will only be executed the first time zsh is invoked
# - - -

if [[ -f /tmp/zsh-has-loaded ]] ; then
  return
fi
touch /tmp/zsh-has-loaded

cd ~/.dotfiles || exit 1

if [[ $ZSHRC_ENV_LOADED != 1 ]] ; then
  export ZSHRC_ENV_LOADED=1
  vterminal
fi
