#!/bin/bash
# kill with fzf
# ＜ キリングアート！

signal="$1"
#FIXME: Don't show current process in fzf
if [[ $(uname) == 'Darwin' ]] ; then
    target_pids=$(ps -axO 'pid,tty,command' | awk 'NR!=1 {print}' | fzf --multi | awk '{print $1}')
else
    target_pids=$(ps -ax --format='pid,tty,command' | awk 'NR!=1 {print}' | fzf --multi | awk '{print $1}')
fi

if [[ "$target_pids" == '' ]] ; then
    echo 'くふん！'
    exit 1
else
    kill $signal $target_pids && echo 'やったわ'
fi
